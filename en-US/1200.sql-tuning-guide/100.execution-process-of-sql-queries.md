Execution process of SQL queries 
=====================================================



The following figure shows the typical execution process of an SQL query from its reception by the SQL engine.

![newSQL request](https://help-static-aliyun-doc.aliyuncs.com/assets/img/en-US/0841526261/p261032.png)

The following table describes SQL query execution steps. 


|                   **Step**                    |                                                                                                                                                                                                                                                                                       **Description**                                                                                                                                                                                                                                                                                        |
|-----------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Parser (lexical and syntactic parsing module) | After Parser receives an SQL query string sent by a user, it splits the string into "words" and parses the entire query based on the preset syntax rules. Then, it converts the SQL query string into an in-memory data structure with syntax structure information, which is called the syntax tree.                                                                                                                                                                                                                                                                                        |
| Plan Cache (cache module for execution plans) | The SQL execution engine caches the execution plan generated for every unique SQL query in the memory to speed up the SQL query processing. The cached plans can be repeatedly executed in the future, which avoids repeated query optimization.                                                                                                                                                                                                                                                                                                                                             |
| Resolver (semantic parsing module)            | Resolver converts the syntax tree generated by Parser into an internal data structure with database semantic information. During the conversion, Resolver translates tokens in the SQL query into the corresponding objects (such as libraries, tables, columns, and indexes) based on the database metadata to generate a statement tree.                                                                                                                                                                                                                                                   |
| Transformer (logic rewriting module)          | After Resolver generates the statement tree, Transformer analyzes the semantics of the user SQL query and rewrites it into an equivalent query based on internal rules or cost models. Then, Transformer sends the equivalent query to Optimizer for optimization. In this process, Transformer performs an equivalent transformation on the original statement tree, and the result of the transformation is still a statement tree.                                                                                                                                                        |
| Optimizer                                     | As the core of the SQL optimization process, Optimizer generates the optimal execution plans for SQL queries. During the optimization, Optimizer needs to comprehensively consider various factors, such as SQL query semantics, object data characteristics, and physical distribution of objects. It solves many problems such as access path selection, connection order selection, connection algorithm selection, and distributed plan generation. Finally, it selects the best execution plan for each SQL query.                                                                      |
| Code Generator                                | Code Generator converts an execution plan to executable code without any optimization.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Executor                                      | Executor starts the execution of an SQL statement.  * For local execution plans, Executor starts by calling the operator at the top of each execution plan. The operator logic completes the entire execution process and returns the execution result.   * For remote or distributed plans, Executor divides the execution tree of each plan into multiple schedulable sub-plans and sends these sub-plans to the relevant nodes for execution through remote procedure calls (RPCs).    |


