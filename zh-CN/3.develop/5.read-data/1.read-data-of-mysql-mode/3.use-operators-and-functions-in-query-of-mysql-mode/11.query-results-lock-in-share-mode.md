# 锁定查询结果 LOCK IN SHARE MODE

`SELECT ... LOCK IN SHARE MODE` 语句用于在查询过程中获取共享锁。共享锁可以防止其他事务对已经锁定的记录进行修改，但是允许其他事务读取已经锁定的记录。在获取共享锁的情况下，其他事务可以共享读取锁定记录的数据，但是不能修改这些记录。

本文将介绍如何使用 `SELECT ... LOCK IN SHARE MODE` 锁定查询结果。

## 注意事项

* `LOCK IN SHARE MODE` 只能防止其他事务修改已经锁定的记录，不能防止其他事务对锁定记录进行删除操作。如果需要防止其他事务对锁定的记录进行删除操作，应该使用排他锁 `SELECT ... FOR UPDATE`，详细信息请参见 [锁定查询结果 SELECT FOR UPDATE](10.lock-query-results-select-for-update-of-mysql-mode.md)。
* `SELECT ... LOCK IN SHARE MODE` 会阻塞读操作。因此，在一般情况下，不建议使用该语法，更不要在性能敏感的场景中使用它。

## 示例

例如下面的 SQL 语句，使用 `LOCK IN SHARE MODE` 语法，在表 `test_tbl1` 中对所有 `id` 值小于 `4` 的记录进行查询，并获取共享锁。

```sql
SELECT * FROM test_tbl1 WHERE id < 4 LOCK IN SHARE MODE;
```

返回结果如下：

```shell
+------+------+
| id   | name |
+------+------+
|    1 | A1   |
|    2 | A2   |
|    3 | A3   |
+------+------+
3 rows in set
```
